---
title: "[Oracle] 오라클 함수"
date: 2025-07-01 17:45:00 +09:00
categories: [Coding, Oracle]
tags:
  - Oracle
---

## #문자 함수

### 1. 대소문자 변경

- **UPPER**(문자열) : 괄호 안 문자를 모두 대문자로 변환하여 반환
- **LOWER**(문자열) : 괄호 안 문자를 모두 소문자로 변환하여 반환
- **INITCAP**(문자열) : 괄호 안 문자 데이터 중 첫 번째 문자만 대문자로 나머지는 소문자로 변환하여 반환

```sql
WHERE 컬럼명 = UPPER('문자열'); // '문자열'을 대문자로 변환하여 조회
WHERE LOWER(컬럼명) = '문자열'; // '문자열'을 소문자로 변환하여 조회
SELECT UPPER(컬럼명), LOWER(컬럼명), INITCAP(컬럼명) FROM 테이블명;
```

### 2. 문자열 길이

- **LENGTH**, **LENGTHB**(문자열에 사용된 바이트 수 반환)

- 문자 하나 당 바이트 수 : 한글(3byte), 영어(1byte)

```sql
SELECT LENGTH('Hello') FROM DUAL;
```

### * DUAL

: 임시 테이블

### 3. 문자열 일부 추출

```sql
SUBSTR (문자열데이터, 시작위치, 추출길이)
SUBSTR (문자열데이터, 시작위치) // 시작 ~ 마지막까지
```

* 시작 위치가 음수라면 오른쪽 끝부터 시작

### 4. 문자열 데이터 안의 특정 문자 위치 찾기

```sql
INSTR (문자열데이터, 위치를 찾으려는 문자, 시작위치, 시작위치에서 몇번째 위치에 있는지)
```

### 5. 특정 문자를 다른 문자로 변경

```sql
REPLACE (문자열데이터, 찾는 문자, 변경할 문자)
```

### 6. 두 문자열 데이터를 합하는 함수

```sql
CONCAT (문자열데이터1, 문자열데이터2)
CONCAT (문자열데이터1, CONCAT(문자열데이터2, 문자열데이터3))
문자열데이터1 || 문자열데이터2 || ...
```

### 7. 공백 제거

```sql
TRIM (삭제옵션(선택), 삭제할문자) FROM 원본문자열 // 공백 제거
LTRIM (삭제옵션(선택), 삭제할문자) FROM 원본문자열 // 왼쪽 공백제거
RTRIM (삭제옵션(선택), 삭제할문자) FROM 원본문자열 // 오른쪽 공백제거
TRIM (LEADING '삭제할 문자' FROM '원본문자열') // 첫번째문자 제거
TRIM (TRAILING '삭제할 문자' FROM '원본문자열') // 마지막문자 제거
TRIM (BOTH '삭제할 문자' FROM '원본문자열') // 양쪽 끝 문자 제거
```

## #숫자 함수 : 숫자 데이터에 적용

- 반올림, 올림, 버림, 나머지 값 구하기

### 1. 반올림

```sql
ROUND (숫자, 반올림 위치)
```

### 2. 버림

```sql
TRUNC (숫자, 버릴 위치)
```

### 3. 지정한 숫자와 가까운 정수 찾기

```sql
CEIL (숫자) // 지정한 숫자보다 큰 정수 중 가장 작은 정수 반환
FLOOR (숫자) // 지정한 숫자보다 작은 정수 중 가장 큰 정수 반환
```

### 4. 나머지

```sql
MOD (숫자, 나누는 값)
```

## #날짜  함수

### 1. 오늘 날짜

- **SYSDATE**
- **CURRENT_DATE**
- **CURRENT_TIMESTAMP**

### 2. 날짜 데이터 + 숫자

: 날짜 데이터보다 숫자만큼 이후의 날짜

### 3. 몇 개월 이후의 날짜 구하기

```sql
ADD_MONTHS(원래 날짜, 구하는 개월수)
```

### 4. 두 날짜 간의 개월 수 차이

```sql
MONTHS_BETWEEN(날짜1, 날짜2)
```

### 5. 특정 날짜를 기준으로 돌아오는 요일의 날짜 출력

```sql
NEXT_DAY (날짜, 요일)
```

### 6. 특정 날짜가 속한 달의 마지막 날짜 출력

```sql
LAST_DAY(날짜)
```

### 7. 데이터 타입(자료형)

- **NUMBER**(숫자)
    - NUMBER(2, 0) : 숫자 2자리 까지 허용
- **VARCHAR2**(문자)
- **DATE**(날짜/시간)
- 자료형 변환 (날짜 -> 문자, 문자 -> 숫자)

### 8. TO_CHAR

: 데이터를 출력할 문자형식 지정 (주로 날짜 데이터에 사용)

```sql
TO_CHAR(날짜(숫자), '문자형식')
```

- Y : 연도
- M : 월
- D : 일
- HH : 시
- MI : 분
- SS : 초
- HH24 : 시를 24시간으로
- AM(PM) : 오전, 오후

### 💡 TO_CHAR() 함수의 날짜 포맷

| 날짜 포멧 | 출력 예시 | 설명 |
| --- | --- | --- |
| to_char(sysdate, 'YYYYMMDD') | 20220706 | YYYY: 년, MM: 월, DD: 일 |
| to_char(sysdate, 'YYYY-MM-DD HH24:MI:SS') | 2022-07-06 14:32:18 | HH24: 24시간으로 표시, HH: 12시간으로 표시, MI:분, SS: 초 |
| to_char(sysdate, 'FMMM-DD') | 7-6 | 날짜의 앞에 표시되는 0 없애는 포맷 |
| to_char(sysdate, 'D') | 4 (1(일) ~ 7(토)) |  |
| to_char(sysdate, 'DY') | 수 |  |
| to_char(sysdate, 'DAY') | 수요일 |  |
| to_char(sysdate, 'MON') | 7월 |  |
| to_char(sysdate, 'DL') | 2022년 7월 6일 수요일 |  |

### 9. TO_NUMBER

: 문자열 데이터를 지정한 형태의 숫자로 인식하여 숫자 데이터로 변환

```sql
TO_NUMBER(문자열, '숫자형식')
```

- 9 : 숫자의 한 자리를 의미함(빈자리를 채우지 않음)
- 0 : 빈 자리를 0으로 채움

### 10. TO_DATE

: 문자 데이터를 날짜 데이터로 변환

```sql
TO_DATE(문자, '인식될 날짜 형태')

SELECT TO_DATE('2024-01-24') - TO_DATE('2023-12-31')
FROM DUAL; // 두 날짜 간의 일수 출력
```

### 11. NULL 처리 함수

- 널 * 숫자 → NULL, 널 + 숫자 → NULL
- NULL 을 다른 값으로 변경

```sql
NVL(NULL 인지 검사할 컬럼명 (OR 데이터), 대체할 데이터)
NVL2(NULL 인지 검사할 컬럼명 (OR 데이터), NULL 이 아닌경우 반환 데이터(계산식), NULL 인 경우 반환 데이터(계산식))
```

### 12. DECODE 함수 / CASE

```sql
DECODE(검사대상, 조건1,조건1이 참일 때 반환할 결과,
       조건2, 조건2 가 참일 때 반환할 결과,......., 조건1~조건n 일치하지 않는 경우 반환할 결과)
```

```sql
CASE 검사대상 
WHEN 조건1 THEN 조건1 이 참일 때 반환할 결과
WHEN 조건n THEN 조건n 이 참일 때 반환할 결과
ELSE 조건1~조건n 일치하지 않는 경우 반환할 결과
END
```